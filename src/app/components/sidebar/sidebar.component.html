<!-- Mobile Backdrop: shown when sidebar is open on mobile -->
@if (isMobile() && !isLeftSidebarCollapsed()) {
  <div
    class="sidebar-backdrop"
    (click)="closeSidenav()"
    aria-hidden="true"
  ></div>
}

<div
  class="sidebar-container bg-card border-r border-secondary-200 dark:border-secondary-800 top-0 z-30 h-screen fixed"
  [ngClass]="{
    'sidebar-mobile': isMobile(),
    'sidebar-mobile-open': isMobile() && !isLeftSidebarCollapsed(),
    'sidebar-desktop-mini': !isMobile() && isLeftSidebarCollapsed(),
    'sidebar-desktop-full': !isMobile() && !isLeftSidebarCollapsed(),
  }"
>
  <!-- Sidebar Header -->
  <div class="flex items-center w-full p-4">
    <button
      class="text-center items-center justify-center flex h-10 w-10 rounded-lg p-1 text-xl font-black cursor-pointer min-w-[2.5rem] border border-secondary-200 dark:border-secondary-700 hover:bg-primary-50 dark:hover:bg-secondary-800 transition-colors duration-200"
      (click)="toggleCollapse()"
    >
      <i class="pi pi-bars dark:text-foreground"></i>
    </button>
    @if (!isLeftSidebarCollapsed()) {
      <div
        class="ml-4 text-xl font-bold text-foreground truncate transition-all duration-300"
      >
        BankEase
      </div>
    }
  </div>

  <!-- Sidebar Menu -->
  <ul
    style="scrollbar-width: none"
    class="p-4 m-0 flex flex-col items-center list-none h-[calc(100%-4rem)] w-full overflow-y-auto"
  >
    @for (item of items(); track item.routeLink ?? item.label) {
      <li
        class="w-full mb-1"
        [pTooltip]="!isMobile() && isLeftSidebarCollapsed() ? item.label : ''"
        tooltipPosition="right"
      >
        <div
          class="flex items-center h-11 text-foreground no-underline rounded-lg cursor-pointer px-2 hover:bg-primary-100 dark:hover:bg-secondary-800 hover:text-primary-700 dark:hover:text-primary-400 transition-all duration-200"
          (click)="handleItemClick(item)"
          [routerLink]="!item.isParent ? item.routeLink : null"
          [routerLinkActive]="!item.isParent ? 'active-nav-item' : ''"
          [routerLinkActiveOptions]="{ exact: true }"
        >
          <i
            class="text-xl w-8 text-center min-w-[2rem] transition-colors duration-200"
            [class]="item.icon"
          ></i>
          @if (!isLeftSidebarCollapsed() || isMobile()) {
            <span class="ml-3 flex-1 text-sm font-medium truncate">{{
              item.label
            }}</span>
            @if (item.isParent) {
              <i
                class="pi text-xs transition-transform duration-300"
                [ngClass]="
                  item.expanded ? 'pi-chevron-down' : 'pi-chevron-right'
                "
              ></i>
            }
          }
        </div>
      </li>
    }
  </ul>
</div>
